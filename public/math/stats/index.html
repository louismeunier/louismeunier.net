<!doctype html>
<html lang="en-us">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title> ðŸ“Š basic statistics in R - louis meunier </title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="referrer" content="no-referrer">
    <meta name="title" content=" ðŸ“Š basic statistics in R - louis meunier ">
    <meta name="keywords" content="programming, mathematics, math">
    <meta name="robots" content="index, follow">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="language" content="English">
    <meta name="author" content="Louis Meunier">
    <meta name="description" content="compilation of basic functions and visualizations in R" />

    <meta property="og:site_name" content="louis meunier" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://louismeunier.net/math/stats/" />
    <meta property="og:title" content="ðŸ“Š basic statistics in R" />
    <meta property="og:image" content="https://louismeunier.net/" />
    <meta property="og:description" content="compilation of basic functions and visualizations in R" />

    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="ðŸ“Š basic statistics in R" />
    <meta name="twitter:description" content="compilation of basic functions and visualizations in R" />
    <meta name="twitter:image" content="https://louismeunier.net/" />

    <link rel="canonical" href="https://louismeunier.net/math/stats/">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Merriweather&display=swap" rel="stylesheet"> 
    <link rel="stylesheet" href="https://louismeunier.net/css/custom.css" />

    

    

    <link rel="shortcut icon"
        href="https://louismeunier.net/images/favicon.svg">

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-SREEFSD05C"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-SREEFSD05C');
    </script>
</head>

<body>
    
    <div class="mt-xl header">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-auto">
                
                    <h1 class="name">louis meunier</h1>
                
            </div>
        </div>

        <div class="row justify-content-center">
            <ul class="nav nav-primary justify-content-center">
                
                <li class="nav-item">
                    <a class="nav-link" href="https://louismeunier.net/">
                        
                        Home
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="https://louismeunier.net/coding">
                        
                        Coding
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="https://louismeunier.net/math">
                        
                        Math
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="https://louismeunier.net/notes">
                        
                        Notes
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="https://louismeunier.net/cubing">
                        
                        Cubing
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="https://github.com/louismeunier">
                        
                        Github
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="https://linkedin.louismeunier.net">
                        
                        Linkedin
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

    <div class="content">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-sm-12 col-lg-10">
                    <h1 class="mx-0 mx-md-4 text-center display-5 ">ðŸ“Š basic statistics in R</h1>
                    <div class="markdown">
                        
    <a name="back to top" id="topButton"  class="no-pointer" href="#">top</a>
<script>
    window.onscroll = scrollFunction;
    function scrollFunction() {
        if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
            document.getElementById("topButton").style.color = "rgba(27, 31, 35, 0.6)";
            document.getElementById("topButton").classList.remove("no-pointer");
        } else {
            document.getElementById("topButton").style.color = "rgba(27, 31, 35, 0.0)";
            document.getElementById("topButton").classList.add("no-pointer");
        }
    }
</script>
<style>
    #topButton {
        position: fixed;
        right: 0;
        bottom: 0;
        transition: 0.3s ease-in-out;
        margin-right: 0.5em;
        margin-bottom: 50vh;
        width: 2em;
        height: 2em;
        color:rgba(27, 31, 35, 0.0);
        text-decoration: none;
        font-size: 0.8em;
    }
    #topButton.no-pointer:hover {
        cursor: default;
    }
    #topButton:hover {
        cursor: pointer;
        text-decoration: underline;
    }
</style>
<p>Some simple statistics functions in R (based on the course <a href="https://www.mcgill.ca/study/2022-2023/courses/math-204">MATH204</a>).</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#008000"># read data</span>
</span></span><span style="display:flex;"><span>data &lt;- read.csv(<span style="color:#a31515">&#34;data.csv&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000"># utilities for working with/summarize data</span>
</span></span><span style="display:flex;"><span>ncol(data) <span style="color:#008000"># number of columns</span>
</span></span><span style="display:flex;"><span>nrow(data) <span style="color:#008000"># number of rows</span>
</span></span><span style="display:flex;"><span>colnames(data) <span style="color:#008000"># column names</span>
</span></span><span style="display:flex;"><span>rownames(data) <span style="color:#008000"># row names (if they exist)</span>
</span></span><span style="display:flex;"><span>head(data) <span style="color:#008000"># get the first &#34;few&#34; rows of a dataframe</span>
</span></span><span style="display:flex;"><span>tail(data) <span style="color:#008000"># get the last &#34;few&#34; rows of a dataframe</span>
</span></span><span style="display:flex;"><span>summary(data) <span style="color:#008000"># get more information then you&#39;d ever need</span>
</span></span><span style="display:flex;"><span>data[data$x == <span style="color:#a31515">&#34;something&#34;</span>, ] <span style="color:#008000"># get all rows from data from matching certain parameter(s)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data.lm &lt;- lm(y ~ x, data = data) <span style="color:#008000"># fit a linear model</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000"># working with the model (also applies to non-linear models made this way)</span>
</span></span><span style="display:flex;"><span>data.lm <span style="color:#008000"># just displays the coefficients</span>
</span></span><span style="display:flex;"><span>summary(data.lm) <span style="color:#008000"># displays coefficients, their standard errors, t-statistics, and p-values, etc.</span>
</span></span><span style="display:flex;"><span>anova(data.lm) <span style="color:#008000"># analysis of variance; F-statistic, etc</span>
</span></span><span style="display:flex;"><span>confint(data.lm, level=1-0.01) <span style="color:#008000"># confidence intervals for the coefficients</span>
</span></span><span style="display:flex;"><span>predict(data.lm, newdata = data.frame(x = 1:10)) <span style="color:#008000"># predict y values for x = 1:10</span>
</span></span><span style="display:flex;"><span><span style="color:#008000"># make sure the column in the newdata is named the same as the column passed to lm!</span>
</span></span><span style="display:flex;"><span><span style="color:#008000"># using predict, you can either predict for an individual response or mean response</span>
</span></span><span style="display:flex;"><span><span style="color:#008000"># just change the &#34;interval&#34; argument to &#34;prediction&#34; or &#34;confidence&#34; respectively</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000"># a linear model can be added as a line to a plot</span>
</span></span><span style="display:flex;"><span>plot(y ~ x, data = data)
</span></span><span style="display:flex;"><span>abline(data.lm, col = <span style="color:#a31515">&#34;red&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>lines(data$x[sort(x, index.return=T)$ix], data.lm[ix], col=<span style="color:#a31515">&#34;red&#34;</span>) <span style="color:#008000"># a non-linear model can also be added to a plot (just a little more complicated)</span>
</span></span><span style="display:flex;"><span><span style="color:#008000"># this can be made a little fancier with ggplot to add the confidence intervals</span>
</span></span><span style="display:flex;"><span>library(ggplot2)
</span></span><span style="display:flex;"><span>ggplot(data, aes(x = x, y = y)) +
</span></span><span style="display:flex;"><span>  geom_point() +
</span></span><span style="display:flex;"><span>  geom_smooth(method = <span style="color:#a31515">&#34;lm&#34;</span>, se = <span style="color:#00f">TRUE</span>, color = <span style="color:#a31515">&#34;red&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000"># lm can also be used to fit a polynomial</span>
</span></span><span style="display:flex;"><span>lm(y ~ x + I(x^2), data = data) <span style="color:#008000"># I() is used to indicate that x^2 is a variable, not an operation</span>
</span></span><span style="display:flex;"><span><span style="color:#008000"># or covariates</span>
</span></span><span style="display:flex;"><span>lm(y ~ x + z, data = data)
</span></span><span style="display:flex;"><span><span style="color:#008000"># or interactions</span>
</span></span><span style="display:flex;"><span>lm(y ~ x*z, data = data) <span style="color:#008000"># note that this is the same as lm(y ~ x + z + x:z, data = data)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000"># test statistics can also be manually found</span>
</span></span><span style="display:flex;"><span>alpha = 0.05
</span></span><span style="display:flex;"><span>df = 10
</span></span><span style="display:flex;"><span><span style="color:#008000"># t-test</span>
</span></span><span style="display:flex;"><span>t.test(y ~ x, data=data) <span style="color:#008000"># 1-tailed</span>
</span></span><span style="display:flex;"><span>t.test(y ~ x, data=data, var.equal=T) <span style="color:#008000"># 2-tailed</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>qt(1 - alpha/2, df = df) <span style="color:#008000"># t-statistic for a 95% confidence interval with 10 degrees of freedom</span>
</span></span><span style="display:flex;"><span>2*pt(-abs(2.228), df = df) <span style="color:#008000"># p-value for a t-statistic of 2.262 with 10 degrees of freedom; two-tailed</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000"># Z-test</span>
</span></span><span style="display:flex;"><span>qnorm(1 - alpha/2) <span style="color:#008000"># z-statistic for a 95% confidence interval</span>
</span></span><span style="display:flex;"><span>2*pnorm(-abs(1.96)) <span style="color:#008000"># p-value for a z-statistic of 1.96; two-tailed</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000"># F-test</span>
</span></span><span style="display:flex;"><span>qf(1 - alpha, df1 = 1, df2 = df) <span style="color:#008000"># F-statistic for a 95% confidence interval with 1 and 10 degrees of freedom</span>
</span></span><span style="display:flex;"><span>aov(y ~ x, data=data) <span style="color:#008000"># another way of doing a global F-test; wrap with summary() to get more information</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000"># residuals</span>
</span></span><span style="display:flex;"><span>residuals(data.lm) <span style="color:#008000"># get the residuals of a model</span>
</span></span><span style="display:flex;"><span>data.lm$residuals <span style="color:#008000"># same as above</span>
</span></span><span style="display:flex;"><span>library(MASS) <span style="color:#008000"># library that makes it easy to work with residuals</span>
</span></span><span style="display:flex;"><span>data.lm.stdres &lt;- stdres(residuals(data.lm)) <span style="color:#008000"># standardized residuals</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>par(mfrow = c(1, 2))
</span></span><span style="display:flex;"><span>hist(data.lm.stdres) <span style="color:#008000"># plot the standardized residuals</span>
</span></span><span style="display:flex;"><span>qqnorm(data.lm.stdres) <span style="color:#008000"># plot the standardized residuals against a normal distribution</span>
</span></span><span style="display:flex;"><span>qqline(data.lm.stdres) <span style="color:#008000"># plot the standardized residuals against a normal distribution</span>
</span></span><span style="display:flex;"><span><span style="color:#008000"># plotting these side-by-side is a good way to check if the residuals are normally distributed</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>library(interactions)
</span></span><span style="display:flex;"><span>interact_plot(data.lm, pred = x.1, modx = x.2) <span style="color:#008000"># plot interactions (assuming data.lm is a model with an interaction)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>boxplot(y ~ x, data=data) <span style="color:#008000"># box-plot, helpful for qualitative data</span>
</span></span><span style="display:flex;"><span>aggregate(x = data$y, by = list(data$x), FUN = mean) <span style="color:#008000"># get the mean of y for each x</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>anova(mod_1, mod_2) <span style="color:#008000"># compare two models, mod_1 smaller than mod_2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>chisq.test(x_1, x_2) <span style="color:#008000"># chi-squared test, for categorical data</span>
</span></span><span style="display:flex;"><span>qchisq(1 - alpha, df = df. lower.tail=T) <span style="color:#008000"># chi-squared significant value</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>fisher.test(x_1, x_2) <span style="color:#008000"># fisher&#39;s exact test, for categorical data</span>
</span></span><span style="display:flex;"><span>mcnemar.test(data, correct = <span style="color:#00f">FALSE</span>) <span style="color:#008000"># mcnemar&#39;s test, for paired categorical data</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>wilcox.test(x_1, x_2, alternative=<span style="color:#a31515">&#34;greater&#34;</span>, correct = F) <span style="color:#008000"># wilcoxon rank sum test</span>
</span></span><span style="display:flex;"><span>wilcox.test(x_1, x_2, alternative=<span style="color:#a31515">&#34;greater&#34;</span>, correct = F, exact = F) <span style="color:#008000"># wilcoxon rank sum test, larger samples, approximates normal distribution</span>
</span></span></code></pre></div><!-- todo: anova, kw, spearman -->


                    </div>
                    <div class="back-temp">
                        <a class="fake-button" href="https://louismeunier.net/math">
                            <button class="btn btn-outline-secondary text-center">
                            back to: math
                            </button>
                        </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    

    <footer class="footers">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-auto">
             <p><a href="https://github.com/louismeunier/louismeunier.net" target="_blank">source code</a> | built with <a href="https://gohugo.io/" target="_blank">hugo ðŸ”¨</a>
            </div>
        </div>
    </div>
</footer>


    

    

    

    
    
        
<script src="https://louismeunier.net/js/math-code.js"></script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        processEscapes: true
      }
    });
  </script>
      


    
</body>

</html>
